<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline' 'unsafe-eval';">
    <title>Game Emulator</title>

    <!-- Correction des chemins vers les fichiers JS et CSS -->
    <script src="emulatorjs/data/emulator.min.js"></script>
    <link rel="stylesheet" href="emulatorjs/data/emulator.min.css">
</head>
<body>
    <h1>Emulateur de Jeux</h1>

    <label for="romFile">Choisissez votre fichier ROM :</label>
    <input type="file" id="romFile" accept=".gb, .gba, .nes, .snes, .zip">

    <button id="startButton" onclick="loadRom()">Démarrer l'émulation</button>

    <canvas id="emulatorCanvas" width="640" height="480" style="border:1px solid #000;"></canvas>

    <script>
        function loadRom() {
            const fileInput = document.getElementById('romFile');
            const file = fileInput.files[0];

            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const arrayBuffer = e.target.result;
                    startEmulation(arrayBuffer);
                };
                reader.readAsArrayBuffer(file);
            } else {
                alert('Veuillez sélectionner un fichier ROM.');
            }
        }

        // Fonction de démarrage de l'émulateur avec EmulatorJS
        function startEmulation(romData) {
            EJS_start({
                gameData: romData,
                system: 'gba',
                canvasId: 'emulatorCanvas',
                autoplay: true,
                width: 640,
                height: 480
            });
        }
    </script>
</body>
</html>
