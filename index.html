<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline' 'unsafe-eval' https://sanctuary.kindredlabs.ai;">
    <title>Game Emulator</title>

    <!-- Inclusion du fichier EmulatorJS -->
    <script src="emulatorjs/data/emulator.min.js"></script>
    <script src="emulatorjs/data/GameManager.js"></script>
    <link rel="stylesheet" href="emulatorjs/data/emulator.min.css">
</head>
<body>
    <h1>Emulateur de Jeux</h1>

    <!-- Zone de téléchargement de ROM -->
    <label for="romFile">Choisissez votre fichier ROM :</label>
    <input type="file" id="romFile" accept=".gb, .gba, .nes, .snes, .zip">

    <!-- Bouton pour démarrer l'émulation -->
    <button id="startButton" onclick="loadRom()">Démarrer l'émulation</button>

    <!-- Zone où l'émulation sera affichée -->
    <canvas id="emulatorCanvas" width="640" height="480" style="border:1px solid #000;"></canvas>

    <!-- Script pour gérer le téléchargement et le démarrage de la ROM -->
    <script>
        // Fonction pour charger la ROM et lancer l'émulation
        function loadRom() {
            const fileInput = document.getElementById('romFile');
            const file = fileInput.files[0];

            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const arrayBuffer = e.target.result;
                    startEmulation(arrayBuffer);
                };
                reader.readAsArrayBuffer(file);
            } else {
                alert('Veuillez sélectionner un fichier ROM.');
            }
        }

        // Fonction pour démarrer l'émulation avec EmulatorJS
        function startEmulation(romData) {
            EJS_start({
                gameData: romData,
                system: 'gba', // Modifiez ici selon le système : gb, nes, snes, gba, etc.
                canvasId: 'emulatorCanvas',
                autoplay: true, // Lance automatiquement le jeu
                width: 640,
                height: 480
            });
        }
    </script>
</body>
</html>
